@using VeteranAnalyticsSystem.Models.Core
@model ApplicationUser

<h1>Account Settings</h1>

@if (Model == null)
{
    <p>Sorry, we couldn't find your account details.</p>
}
else
{
    <!-- Display a summary of validation errors -->
    @Html.ValidationSummary(true, "", new { @class = "alert alert-danger" })

    <!-- Display success message if it exists -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success" id="successMessage">
            @TempData["SuccessMessage"]
        </div>
    }

    <form asp-action="UpdateAccount" method="post">
        <div class="form-group">
            <label asp-for="FirstName"></label>
            <input asp-for="FirstName" class="form-control" />
            <span asp-validation-for="FirstName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="LastName"></label>
            <input asp-for="LastName" class="form-control" />
            <span asp-validation-for="LastName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Email"></label>
            <input asp-for="Email" class="form-control" />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="PhoneNumber"></label>
            <input asp-for="PhoneNumber" class="form-control" />
            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
        </div>

        <!-- Optional Password Update -->
        <div class="form-group">
            <label for="NewPassword">New Password (Leave blank if not changing)</label>
            <input type="password" name="NewPassword" class="form-control" />
        </div>

        <div class="form-group">
            <label for="ConfirmNewPassword">Confirm New Password (Leave blank if not changing)</label>
            <input type="password" name="ConfirmNewPassword" class="form-control" />
        </div>

        <div class="form-group">
            <label for="CurrentPassword">Current Password *Required</label>
            <input type="password" name="CurrentPassword" class="form-control" required />
        </div>

        <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        // Automatically hide success message after 5 seconds (5000ms)
        setTimeout(function () {
            var successMessage = document.getElementById("successMessage");
            if (successMessage) {
                successMessage.style.display = 'none';
            }
        }, 5000); // 5000 milliseconds = 5 seconds
    </script>
}
